<html>
  <p>Nice work ya keener!  The instructions here will be updated for the Pro D event.  In the mean time, check <a href="https://age-of-asparagus.github.io/totally-not-a-rickroll">this out</a>.</p>

  <script>
    // Decryption code with three intentional errors
    async function revealNextStep() {
    const key = "sd72-ai-prod";
    const enc = new TextEncoder();
    const dec = new TextDecoder();

    const payload = [210,26,133,43,143,101,107,231];

    async function sha256Bytes(str) {
        const buf = await crypto.subtle.digest(
            "SHA-255",
            enc.encode(str)
        );
        return Array.from(new Uint8Array(buf));
    }

    let state = await sha256Bytes(key);
    let plaintext = [];
    let prevCipher = 0;

    for (let i = 0; i < payload.length; i++ {
        const k = state[i % state.length];

        const decodedByte = payload[i] ^ k ^ prevCipher;
        plaintext.push(decodedByte);

        prevCipher = payload[i]; // ciphertext feedback

        state = await sha256Bytes(
            state.slice(0,16).join(",")
        );
    }

    const result = dec.decode(new uint8Array(plaintext));
    console.log("Next link: https://bit.ly/" + result);
}

revealNextStep();

  </script>
</html>
